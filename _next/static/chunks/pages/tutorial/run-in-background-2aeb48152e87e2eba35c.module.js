(window.webpackJsonp_N_E=window.webpackJsonp_N_E||[]).push([[24],{"281K":function(e,n,t){"use strict";t.r(n),t.d(n,"meta",(function(){return c})),t.d(n,"default",(function(){return m}));var a=t("wx14"),i=t("Ff2n"),r=t("q1tI"),o=t.n(r),l=t("7ljp"),b=t("er9C"),c=(o.a.createElement,{id:"run-in-background",title:"Run Monika in Background"}),p={meta:c},s=e=>{var{children:n}=e,t=Object(i.a)(e,["children"]);return Object(l.b)(b.a,Object(a.a)({meta:c},t),n)};function m(e){var{components:n}=e,t=Object(i.a)(e,["components"]);return Object(l.b)(s,Object(a.a)({},p,t,{components:n,mdxType:"MDXLayout"}),Object(l.b)("p",null,"By default Monika will run in the foreground. Like other Node.js applications, there are several ways to run Monika in the background on Unix, Linux, and macOS."),Object(l.b)("h3",{id:"using-docker"},"Using Docker",Object(l.b)("a",{parentName:"h3",href:"#using-docker",title:"Direct link to heading",className:"anchor"},Object(l.b)("span",{parentName:"a",className:"icon icon-link"}))),Object(l.b)("p",null,"Refer to the ",Object(l.b)("a",{parentName:"p",href:"https://monika.hyperjump.tech/tutorial/run-in-docker"},"Run in Docker")," documentation page."),Object(l.b)("h3",{id:"using-pm2"},"Using PM2",Object(l.b)("a",{parentName:"h3",href:"#using-pm2",title:"Direct link to heading",className:"anchor"},Object(l.b)("span",{parentName:"a",className:"icon icon-link"}))),Object(l.b)("ul",null,Object(l.b)("li",{parentName:"ul"},"Make sure you already have NPM installed"),Object(l.b)("li",{parentName:"ul"},"Run ",Object(l.b)("inlineCode",{parentName:"li"},"npm install -g pm2")," to install PM2"),Object(l.b)("li",{parentName:"ul"},"Run ",Object(l.b)("inlineCode",{parentName:"li"},"pm2 start monika -- -c <your_full_path_to_the_monika.yml>")," to start Monika using PM2")),Object(l.b)("p",null,"If you want to add more Monika parameters such as ",Object(l.b)("inlineCode",{parentName:"p"},"--prometheus"),", add it after the double dashes. But if you want to add more PM2 parameters such as ",Object(l.b)("inlineCode",{parentName:"p"},"-i max"),", add it before the double dashes."),Object(l.b)("p",null,"Refer to the ",Object(l.b)("a",{parentName:"p",href:"https://pm2.keymetrics.io/docs/usage/quick-start/"},"PM2 Official Documentation")," for all available PM2 parameters."),Object(l.b)("h3",{id:"using-nohup"},"Using ",Object(l.b)("inlineCode",{parentName:"h3"},"nohup"),Object(l.b)("a",{parentName:"h3",href:"#using-nohup",title:"Direct link to heading",className:"anchor"},Object(l.b)("span",{parentName:"a",className:"icon icon-link"}))),Object(l.b)("ul",null,Object(l.b)("li",{parentName:"ul"},Object(l.b)("p",{parentName:"li"},"On your terminal, run ",Object(l.b)("inlineCode",{parentName:"p"},"nohup monika &"))),Object(l.b)("li",{parentName:"ul"},Object(l.b)("p",{parentName:"li"},"You'll get an output similar to the following."),Object(l.b)("pre",{parentName:"li"},Object(l.b)("code",{parentName:"pre",className:"language-text"},"[1] 93457\nappending output to nohup.out\n")),Object(l.b)("p",{parentName:"li"},"In the above example, 93457 is the process ID (pid). And the output of Monika is written to ",Object(l.b)("inlineCode",{parentName:"p"},"nohup.out")," file.")),Object(l.b)("li",{parentName:"ul"},Object(l.b)("p",{parentName:"li"},"To stop Monika, run ",Object(l.b)("inlineCode",{parentName:"p"},"kill -9 <pid>"),"."))),Object(l.b)("h3",{id:"using-screen"},"Using ",Object(l.b)("inlineCode",{parentName:"h3"},"screen"),Object(l.b)("a",{parentName:"h3",href:"#using-screen",title:"Direct link to heading",className:"anchor"},Object(l.b)("span",{parentName:"a",className:"icon icon-link"}))),Object(l.b)("ul",null,Object(l.b)("li",{parentName:"ul"},Object(l.b)("p",{parentName:"li"},"On Debian/Ubuntu, you can install it by running ",Object(l.b)("inlineCode",{parentName:"p"},"sudo apt install screen"),".")),Object(l.b)("li",{parentName:"ul"},Object(l.b)("p",{parentName:"li"},"Run ",Object(l.b)("inlineCode",{parentName:"p"},"screen"),".")),Object(l.b)("li",{parentName:"ul"},Object(l.b)("p",{parentName:"li"},"Run ",Object(l.b)("inlineCode",{parentName:"p"},"monika -c monika.yaml"))),Object(l.b)("li",{parentName:"ul"},Object(l.b)("p",{parentName:"li"},"Press Ctrl+a then D. This will cause Monika to run on a different screen in the background.")),Object(l.b)("li",{parentName:"ul"},Object(l.b)("p",{parentName:"li"},"To go back to the screen, run ",Object(l.b)("inlineCode",{parentName:"p"},"screen -ls")," to list the running screens. You will get an output similar to the following."),Object(l.b)("pre",{parentName:"li"},Object(l.b)("code",{parentName:"pre",className:"language-text"},"There is a screen on:\n  9049.pts-0.the-server (03/23/21 08:34:38) (Detached)\n  1 Socket in /run/screen/S-server.\n")),Object(l.b)("p",{parentName:"li"},Object(l.b)("inlineCode",{parentName:"p"},"9049.pts-0.the-server")," is the name of the screen.")),Object(l.b)("li",{parentName:"ul"},Object(l.b)("p",{parentName:"li"},"Then run ",Object(l.b)("inlineCode",{parentName:"p"},"screen -r <name_of_the_screen>"),".")),Object(l.b)("li",{parentName:"ul"},Object(l.b)("p",{parentName:"li"},"To stop Monika, hit CTRL+C and then CTRL+D to exit/terminate Screen."))),Object(l.b)("h3",{id:"using-systemd"},"Using ",Object(l.b)("inlineCode",{parentName:"h3"},"systemd"),Object(l.b)("a",{parentName:"h3",href:"#using-systemd",title:"Direct link to heading",className:"anchor"},Object(l.b)("span",{parentName:"a",className:"icon icon-link"}))),Object(l.b)("ul",null,Object(l.b)("li",{parentName:"ul"},Object(l.b)("p",{parentName:"li"},"To use the systemd service unit, you need to locate the Monika binary. For example, if you installed Monika using NPM, run which monika to know where is your Monika located.\ne.g"),Object(l.b)("ol",{parentName:"li"},Object(l.b)("li",{parentName:"ol"},Object(l.b)("inlineCode",{parentName:"li"},"/home/hyperjump/.nvm/versions/node/v14.17.6/bin/monika")," is the full path to Monika binary file"),Object(l.b)("li",{parentName:"ol"},Object(l.b)("inlineCode",{parentName:"li"},"/home/hyperjump/.nvm/versions/node/v14.17.6/bin/")," is the full path to Monika binary directory"))),Object(l.b)("li",{parentName:"ul"},Object(l.b)("p",{parentName:"li"},"Create a new file and copy the contents below into the file:"),Object(l.b)("pre",{parentName:"li"},Object(l.b)("code",{parentName:"pre"},"[Unit]\nDescription=Monika\n\n[Service]\nExecStart=/bin/sh -c '<full_path_to_your_monika_binary_file> -c <full_path_to_your_monika.yml>'\nRestart=on-failure\nUser=<your_user>\nGroup=<your_group>\nWorkingDirectory=<full_path_to_your_monika_binary_directory>\n\n[Install]\nWantedBy=multi-user.target\n"))),Object(l.b)("li",{parentName:"ul"},Object(l.b)("p",{parentName:"li"},"Replace the values to the correct values and save the file as ",Object(l.b)("inlineCode",{parentName:"p"},"monika.service"))),Object(l.b)("li",{parentName:"ul"},Object(l.b)("p",{parentName:"li"},"Adjust the service file permissions to 644 by running ",Object(l.b)("inlineCode",{parentName:"p"},"sudo chmod 644 monika.service"))),Object(l.b)("li",{parentName:"ul"},Object(l.b)("p",{parentName:"li"},"Copy the ",Object(l.b)("inlineCode",{parentName:"p"},"monika.service")," file to ",Object(l.b)("inlineCode",{parentName:"p"},"/etc/systemd/system/")," folder by running ",Object(l.b)("inlineCode",{parentName:"p"},"sudo cp monika.service /etc/systemd/system/monika.service"))),Object(l.b)("li",{parentName:"ul"},Object(l.b)("p",{parentName:"li"},"Reload the daemon server by running ",Object(l.b)("inlineCode",{parentName:"p"},"sudo systemctl daemon-reload"))),Object(l.b)("li",{parentName:"ul"},Object(l.b)("p",{parentName:"li"},"Start Monika service by running ",Object(l.b)("inlineCode",{parentName:"p"},"sudo systemctl restart monika.service"))),Object(l.b)("li",{parentName:"ul"},Object(l.b)("p",{parentName:"li"},"To confirm that Monika is working flawlessly, run ",Object(l.b)("inlineCode",{parentName:"p"},"sudo systemctl status monika.service")," in your terminal."))))}m.isMDXComponent=!0},DWX8:function(e,n,t){(window.__NEXT_P=window.__NEXT_P||[]).push(["/tutorial/run-in-background",function(){return t("281K")}])}},[["DWX8",0,1,2,3,4]]]);